<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Testing Platform</title>
    <style>
        #publicContent {
            text-align: center;
            padding: 50px;
            font-family: Arial, sans-serif;
        }
        
        #testingPlatform {
            display: none;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        #secretTarget {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            opacity: 0.3;
            background: #ff4444;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10000;
            transition: opacity 0.3s;
            font-size: 18px;
        }
        
        #secretTarget:hover {
            opacity: 0.7;
        }
        
        #passwordModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 10001;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            min-width: 300px;
        }
        
        .test-button {
            padding: 12px 24px;
            margin: 10px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .print-button {
            background: #28a745;
        }
        
        .chatgpt-button {
            background: #10A37F;
        }

        .web-chatgpt-button {
            background: #FF6B35;
        }
        
        .results {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
            transition: all 0.3s ease;
        }

        .results.highlight {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        #cookieResult, #accessibilityResult {
            border: 1px solid #ccc;
            padding: 12px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            min-height: 100px;
            line-height: 1.5;
        }

        #chatgptResult {
            border: 1px solid #10A37F;
            padding: 20px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: Arial, sans-serif;
            background-color: #f0f9f4;
            min-height: 150px;
            line-height: 1.6;
            border-radius: 8px;
            resize: vertical;
            overflow: auto;
            max-height: none;
            transition: all 0.3s ease;
        }

        #chatgptResult.expanded {
            min-height: 300px;
            background: #e8f5e8;
        }

        #cookieResult.fail, #accessibilityResult.fail, #chatgptResult.fail {
            border-color: red;
            color: red;
        }

        #cookieResult.pass, #accessibilityResult.pass, #chatgptResult.pass {
            border-color: green;
            color: green;
        }

        .print-report-container {
            border: 3px solid red !important;
            padding: 20px;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
        }

        #websiteInput {
            width: 70%; 
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        #stateSelect {
            width: 200px;
            padding: 12px;
            margin: 10px;
            border: 2px solid #007bff;
            border-radius: 5px;
            font-size: 16px;
            background: white;
        }

        #chatgptQuestion {
            width: 90%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #10A37F;
            border-radius: 8px;
            font-size: 16px;
            font-family: Arial, sans-serif;
            resize: vertical;
            min-height: 120px;
            max-height: 200px;
        }

        .chatgpt-response-container {
            min-height: 200px;
            max-height: none;
            resize: vertical;
            overflow: auto;
        }

        .word-count {
            text-align: right;
            font-size: 12px;
            color: #666;
            margin-top: -5px;
            margin-bottom: 10px;
        }

        .current-ai {
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background: #10A37F; 
            color: white;
            border-radius: 5px;
        }

        .loading {
            color: #10A37F; 
            font-style: italic;
        }

        .section-title {
            background: #10A37F; 
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 25px 0 15px 0;
            text-align: center;
        }

        .state-compliance {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 25px 0 15px 0;
            text-align: center;
        }

        .form-group {
            margin: 15px 0;
            text-align: center;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .button-group {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        html {
            scroll-behavior: smooth;
        }

        .scroll-target {
            scroll-margin-top: 20px;
        }

        .demo-notice {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            color: #155724;
        }

        .api-status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .api-status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .api-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .api-status.testing {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }
    </style>
</head>
<body>
    <button id="secretTarget" title="Click me 7 times">üéØ</button>

    <div id="passwordModal">
        <div class="modal-content">
            <h3>üîí Enter Password</h3>
            <input type="password" id="passwordInput" placeholder="Enter password" style="
                padding: 10px;
                margin: 10px 0;
                width: 200px;
                font-size: 16px;
                border: 2px solid #ddd;
                border-radius: 5px;
            ">
            <br>
            <button onclick="checkPassword()" style="
                padding: 10px 20px;
                background: #007bff;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                margin-top: 10px;
            ">Login</button>
            <p id="passwordError" style="color: red; display: none; margin-top: 10px;">Incorrect password</p>
        </div>
    </div>

    <div id="publicContent">
        <h1>Welcome to Our Website</h1>
        <p>This is a public website. Nothing to see here for regular visitors.</p>
    </div>

    <div id="testingPlatform">
        <h1>üõ°Ô∏è Your Private Testing Platform</h1>
        <p>Welcome back! Ready to run some tests? üíï</p>
        
        <div class="demo-notice">
            <strong>‚úÖ Live Mode:</strong> Connected to AI service via secure Vercel API endpoint!
        </div>

        <div id="apiStatus" class="api-status testing">
            üîÑ Testing API connection...
        </div>
        
        <div class="state-compliance">
            <h2>üèõÔ∏è State Compliance Testing</h2>
        </div>

        <div class="form-group">
            <label for="stateSelect">Select State for Compliance Analysis:</label>
            <select id="stateSelect">
                <option value="">-- Select a State --</option>
                <option value="california">California</option>
                <option value="newyork">New York</option>
                <option value="florida">Florida</option>
                <option value="texas">Texas</option>
                <option value="georgia">Georgia</option>
                <option value="northcarolina">North Carolina</option>
                <option value="southcarolina">South Carolina</option>
                <option value="utah">Utah</option>
                <option value="virginia">Virginia</option>
                <option value="alabama">Alabama</option>
                <option value="alaska">Alaska</option>
                <option value="arizona">Arizona</option>
                <option value="arkansas">Arkansas</option>
                <option value="colorado">Colorado</option>
                <option value="connecticut">Connecticut</option>
                <option value="delaware">Delaware</option>
                <option value="hawaii">Hawaii</option>
                <option value="idaho">Idaho</option>
                <option value="illinois">Illinois</option>
                <option value="indiana">Indiana</option>
                <option value="iowa">Iowa</option>
                <option value="kansas">Kansas</option>
                <option value="kentucky">Kentucky</option>
                <option value="louisiana">Louisiana</option>
                <option value="maine">Maine</option>
                <option value="maryland">Maryland</option>
                <option value="massachusetts">Massachusetts</option>
                <option value="michigan">Michigan</option>
                <option value="minnesota">Minnesota</option>
                <option value="mississippi">Mississippi</mississippi>
                <option value="missouri">Missouri</option>
                <option value="montana">Montana</option>
                <option value="nebraska">Nebraska</option>
                <option value="nevada">Nevada</option>
                <option value="newhampshire">New Hampshire</option>
                <option value="newjersey">New Jersey</option>
                <option value="newmexico">New Mexico</option>
                <option value="ohio">Ohio</option>
                <option value="oklahoma">Oklahoma</option>
                <option value="oregon">Oregon</option>
                <option value="pennsylvania">Pennsylvania</option>
                <option value="rhodeisland">Rhode Island</option>
                <option value="tennessee">Tennessee</option>
                <option value="vermont">Vermont</option>
                <option value="washington">Washington</option>
                <option value="westvirginia">West Virginia</option>
                <option value="wisconsin">Wisconsin</option>
                <option value="wyoming">Wyoming</option>
            </select>
        </div>
        
        <div class="current-ai" id="currentAI">
            Currently using: <span id="aiName">ChatGPT</span>
        </div>
        
        <div style="text-align: center; margin: 20px 0;">
            <input type="text" id="websiteInput" placeholder="https://www.example.com" value="https://www.thewebswan.com">
        </div>
        
        <div class="button-group">
            <button class="test-button" id="testCookieBtn">üç™ Test Cookie Compliance</button>
            <button class="test-button" id="testAccessibilityBtn">üîç Test Accessibility</button>
            <button class="test-button print-button" onclick="generateReport()">üìÑ Generate Report</button>
        </div>
        
        <div class="results scroll-target" id="cookieResultContainer">
            <h3>Cookie Compliance Results</h3>
            <div id="cookieResult">Select a state and run the cookie test to see results here...</div>
        </div>
        
        <div class="results scroll-target" id="accessibilityResultContainer">
            <h3>Accessibility Results</h3>
            <div id="accessibilityResult">Select a state and run the accessibility test to see results here...</div>
        </div>

        <div class="section-title">
            <h2>üí¨ AI Assistant - Ask Me Anything</h2>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <textarea 
                id="chatgptQuestion" 
                placeholder="Type your question here... (up to 300 words)"
                maxlength="1500"
            ></textarea>
            <div class="word-count">
                <span id="wordCount">0</span>/300 words
                <span id="charCount">0</span>/1500 characters
            </div>
            <div class="button-group">
                <button class="test-button chatgpt-button" onclick="askAI()">
                    üöÄ Ask AI Assistant
                </button>
                <button class="test-button web-chatgpt-button" onclick="window.open('https://chat.openai.com/', '_blank')">
                    üåê Web ChatGPT
                </button>
                <button class="test-button print-button" onclick="generateAIReport()">
                    üìÑ Print Response
                </button>
            </div>
        </div>

        <div class="results scroll-target" id="chatgptResultContainer">
            <h3>AI Assistant Response <small>(Expandable - Up to 1000 words)</small></h3>
            <div id="chatgptResult" class="chatgpt-response-container">Ask a question to see AI response here...</div>
        </div>
    </div>

    <script>
        const stateLaws = {
            california: { 
                cookie: "CCPA/CPRA - California Consumer Privacy Act", 
                accessibility: "Unruh Civil Rights Act + WCAG 2.1 AA" 
            },
            newyork: { 
                cookie: "NY SHIELD Act + Proposed Privacy Law", 
                accessibility: "New York Human Rights Law + WCAG 2.1" 
            },
            florida: { 
                cookie: "Florida Information Protection Act", 
                accessibility: "Florida Civil Rights Act" 
            },
            texas: { 
                cookie: "Texas Identity Theft Enforcement", 
                accessibility: "Texas Human Resources Code" 
            },
            georgia: { 
                cookie: "Georgia Personal Identity Protection", 
                accessibility: "Georgia Equal Access to Services" 
            },
            northcarolina: { 
                cookie: "NC Identity Theft Protection Act", 
                accessibility: "NC Persons with Disabilities Protection" 
            },
            southcarolina: { 
                cookie: "SC Insurance Data Security Act", 
                accessibility: "SC Human Affairs Law" 
            },
            utah: { 
                cookie: "Utah Consumer Privacy Act", 
                accessibility: "Utah Antidiscrimination Act" 
            },
            virginia: { 
                cookie: "VCDPA - Virginia Consumer Data Protection Act", 
                accessibility: "Virginia Human Rights Act" 
            },
            colorado: { cookie: "CPA - Colorado Privacy Act", accessibility: "Colorado Anti-Discrimination Act" },
            connecticut: { cookie: "CTDPA - Connecticut Data Privacy Act", accessibility: "Connecticut Human Rights Law" },
            illinois: { cookie: "BIPA - Biometric Information Privacy Act", accessibility: "Illinois Human Rights Act" },
            nevada: { cookie: "Nevada Privacy Law", accessibility: "Nevada Equal Rights Commission" },
            washington: { cookie: "Washington My Health My Data Act", accessibility: "Washington Law Against Discrimination" }
        };

        // API Configuration (Only ChatGPT endpoint needed)
        const API_CONFIG = {
            baseURL: 'https://access-coo-ws.vercel.app',
            endpoints: {
                chatgpt: '/api/chatgpt'
            }
        };

        let currentAI = 'chatgpt'; 
        let apiConnected = false;

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            checkAPIConnection();
            document.getElementById('aiName').textContent = 'ChatGPT';
        });

        // Smooth scroll function
        function smoothScrollToElement(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.classList.add('highlight');
                element.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center'
                });
                setTimeout(() => {
                    element.classList.remove('highlight');
                }, 3000);
            }
        }
        
        // API Connection Test Function - sends empty prompt
        async function checkAPIConnection() {
            const statusElement = document.getElementById('apiStatus');
            
            try {
                statusElement.innerHTML = 'üîÑ Testing API connection...';
                statusElement.className = 'api-status testing';
                
                const endpointPath = API_CONFIG.endpoints.chatgpt;
                
                const response = await fetch(`${API_CONFIG.baseURL}${endpointPath}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ prompt: "Test connection" }) 
                });

                if (response.ok) {
                    apiConnected = true;
                    statusElement.innerHTML = '‚úÖ API Connected Successfully!';
                    statusElement.className = 'api-status connected';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
                
            } catch (error) {
                apiConnected = false;
                statusElement.innerHTML = `‚ùå API Connection Failed: ${error.message}`;
                statusElement.className = 'api-status error';
            }
        }

        document.getElementById('chatgptQuestion').addEventListener('input', function() {
            const text = this.value;
            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            const chars = text.length;
            
            document.getElementById('wordCount').textContent = words;
            document.getElementById('charCount').textContent = chars;
            
            if (words > 300 || chars > 1500) {
                this.style.borderColor = 'red';
            } else if (words > 250 || chars > 1200) {
                this.style.borderColor = 'orange';
            } else {
                this.style.borderColor = '#10A37F';
            }
        });

        // Main API Call Function
        async function callAPI(endpoint, data) {
            if (!apiConnected) {
                throw new Error('API not connected. Please check the API status above.');
            }

            try {
                const endpointPath = API_CONFIG.endpoints.chatgpt; 
                const fullURL = `${API_CONFIG.baseURL}${endpointPath}`;
                
                const response = await fetch(fullURL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    let errorMessage = errorText;
                    try {
                        const errorJson = JSON.parse(errorText);
                        errorMessage = errorJson.error || errorText;
                    } catch (e) {
                        // Ignore JSON parse error
                    }
                    throw new Error(`HTTP ${response.status}: ${errorMessage}`);
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error(`API Error (${endpoint}):`, error);
                throw error;
            }
        }

        // üåü UPDATED: Test with AI function with new prompt logic
        async function testWithAI(url, type) {
            const state = document.getElementById('stateSelect').value;
            let stateSpecificInfo = '';
            
            if (state && stateLaws[state]) {
                const stateName = document.getElementById('stateSelect').selectedOptions[0].text;
                const laws = stateLaws[state];
                stateSpecificInfo = `\n\nState: ${stateName}\nCookie Law: ${laws.cookie}\nAccessibility Law: ${laws.accessibility}`;
            }
            
            let prompt;

            if (type === "cookie compliance") {
                prompt = `Analyze the website ${url} for Cookie Compliance. ${stateSpecificInfo}

Cookie Compliance Scoring Criteria:
- FULL PASS (100% - Green): If a **Privacy Policy link** is locatable, it automatically constitutes a pass for all three policies (Privacy Policy, Cookie Policy, and Terms & Conditions). This is the key passing condition. The AI must focus on finding this single Privacy Policy link.
- PARTIAL (65% - Yellow): If a Privacy Policy link is missing, but a cookie banner with Accept/Reject or Do Not Sell options is present.
- FAIL (0% - Red): If both a Privacy Policy link and a functional cookie banner are missing.

Provide a detailed analysis including:
1. Overall compliance score (out of 100)
2. Key findings based on the criteria
3. Specific issues detected (only if non-compliant)
4. Recommendations for improvement
5. State-specific compliance notes if applicable`;
            } else if (type === "accessibility") {
                prompt = `Analyze the website ${url} for Accessibility compliance. ${stateSpecificInfo}

Accessibility Compliance Scoring Criteria:
- FULL PASS (100% - Green): The site must have ALL of the following accessibility features: **ADA Compliance (in general), Magnify Glass, A+, A- font resizing, Contrast switcher, Greyscale mode, Underline Links, Read Aloud function, Focus Mode, Big Cursor, Keyboard Help, and Dyslexia Friendly font option.** If all are present, it is a 100% pass.
- PARTIAL (65% - Yellow): If the site has *some* of the required features (e.g., only Contrast and Keyboard help, or only a few of the listed ADA features), it is a partial pass, marked for improvement.
- FAIL (0% - Red): If the site has no evident dedicated accessibility widget/features and is not fundamentally accessible (e.g., missing basic Alt tags, poor contrast).

Provide a detailed analysis including:
1. Overall compliance score (out of 100)
2. Key findings based on the criteria (list which required features are present/missing)
3. Specific issues detected
4. Recommendations for improvement
5. State-specific compliance notes if applicable`;
            }

            try {
                const result = await callAPI('chatgpt', { 
                    prompt: prompt,
                    type: type,
                    url: url,
                    state: state
                });
                
                return result.response || result.message || 'Analysis completed successfully';
            } catch (error) {
                throw new Error(`Failed to get AI analysis: ${error.message}`);
            }
        }

        async function askAI() {
            const question = document.getElementById('chatgptQuestion').value.trim();
            
            if (!question) {
                alert("Please enter a question for the AI Assistant!");
                return;
            }

            const words = question.trim().split(/\s+/).length;
            if (words > 300) {
                alert("Please keep your question under 300 words!");
                return;
            }

            const resultDiv = document.getElementById('chatgptResult');
            resultDiv.innerHTML = `<div class="loading">üí≠ ChatGPT is thinking...</div>`;

            try {
                const result = await callAPI('chatgpt', { 
                    prompt: question,
                    type: 'general',
                    conversational: true
                });

                resultDiv.className = "pass chatgpt-response-container expanded";
                resultDiv.innerHTML = `<strong>ü§ñ ChatGPT Response:</strong>\n\n${result.response || result.message}`;
                
                // CALL: Smooth scroll to AI result container
                smoothScrollToElement('chatgptResultContainer');
                
            } catch (error) {
                resultDiv.className = "fail chatgpt-response-container";
                resultDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        document.getElementById("testCookieBtn").addEventListener("click", async () => {
            const url = document.getElementById("websiteInput").value.trim();
            const state = document.getElementById('stateSelect').value;
            
            if (!url) return alert("Please enter a website URL.");
            if (!state) return alert("Please select a state for compliance testing.");

            const resultDiv = document.getElementById("cookieResult");
            const stateName = document.getElementById('stateSelect').selectedOptions[0].text;
            resultDiv.innerHTML = `<div class="loading">üîÑ Testing Cookie Compliance for ${stateName} with ChatGPT...</div>`;

            try {
                const result = await testWithAI(url, "cookie compliance");
                
                // The AI provides the score in the result text, so we rely on that for the analysis
                resultDiv.className = "pass"; 
                resultDiv.innerHTML = result;
                
                // CALL: Smooth scroll to Cookie result container
                smoothScrollToElement('cookieResultContainer');
                
            } catch (error) {
                resultDiv.className = "fail";
                resultDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        });

        document.getElementById("testAccessibilityBtn").addEventListener("click", async () => {
            const url = document.getElementById("websiteInput").value.trim();
            const state = document.getElementById('stateSelect').value;
            
            if (!url) return alert("Please enter a website URL.");
            if (!state) return alert("Please select a state for compliance testing.");

            const resultDiv = document.getElementById("accessibilityResult");
            const stateName = document.getElementById('stateSelect').selectedOptions[0].text;
            resultDiv.innerHTML = `<div class="loading">üîÑ Testing Accessibility for ${stateName} with ChatGPT...</div>`;

            try {
                const result = await testWithAI(url, "accessibility");
                
                // The AI provides the score in the result text, so we rely on that for the analysis
                resultDiv.className = "pass"; 
                resultDiv.innerHTML = result;
                
                // CALL: Smooth scroll to Accessibility result container
                smoothScrollToElement('accessibilityResultContainer');
                
            } catch (error) {
                resultDiv.className = "fail";
                resultDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        });

        function generateReport() {
            const accessibilityResults = document.getElementById('accessibilityResult').innerHTML;
            const cookieResults = document.getElementById('cookieResult').innerHTML;
            const websiteUrl = document.getElementById('websiteInput').value;
            const stateName = document.getElementById('stateSelect').selectedOptions[0].text;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Website Compliance Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                        .print-report-container { border: 3px solid red !important; padding: 30px; margin: 20px 0; background: white; border-radius: 10px; }
                        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
                        .section { margin-bottom: 40px; }
                        @media print { button { display: none; } body { margin: 20px; } .print-report-container { border: 3px solid red !important; } }
                        .print-controls { text-align: center; margin: 30px 0; padding: 20px; background: #f5f5f5; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>üìä Website Compliance Report</h1>
                        <p><strong>Website:</strong> ${websiteUrl}</p>
                        <p><strong>State:</strong> ${stateName}</p>
                        <p><strong>AI Used:</strong> ChatGPT</p>
                        <p><strong>Generated on:</strong> ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="print-report-container">
                        <div class="section">
                            <h2>üîç Accessibility Analysis</h2>
                            ${accessibilityResults}
                        </div>
                        
                        <div class="section">
                            <h2>üç™ Cookie Compliance</h2>
                            ${cookieResults}
                        </div>
                    </div>
                    
                    <div class="print-controls">
                        <button onclick="window.print()" style="padding: 15px 30px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px;">üñ®Ô∏è Print / Save as PDF</button>
                        <button onclick="window.close()" style="padding: 15px 30px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px;">Close Window</button>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        function generateAIReport() {
            const aiResults = document.getElementById('chatgptResult').innerHTML;
            const question = document.getElementById('chatgptQuestion').value;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>AI Assistant Conversation Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                        .print-report-container { border: 3px solid #10A37F !important; padding: 30px; margin: 20px 0; background: white; border-radius: 10px; }
                        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
                        .section { margin-bottom: 40px; }
                        .question { background: #f0f9f4; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
                        @media print { button { display: none; } body { margin: 20px; } .print-report-container { border: 3px solid #10A37F !important; } }
                        .print-controls { text-align: center; margin: 30px 0; padding: 20px; background: #f5f5f5; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>üí¨ AI Assistant Conversation Report</h1>
                        <p><strong>Generated on:</strong> ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="print-report-container">
                        <div class="section">
                            <h2>‚ùì Your Question</h2>
                            <div class="question">${question}</div>
                        </div>
                        
                        <div class="section">
                            <h2>ü§ñ AI Assistant Response</h2>
                            ${aiResults}
                        </div>
                    </div>
                    
                    <div class="print-controls">
                        <button onclick="window.print()" style="padding: 15px 30px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px;">üñ®Ô∏è Print / Save as PDF</button>
                        <button onclick="window.close()" style="padding: 15px 30px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px;">Close Window</button>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        let clickCount = 0;
        const requiredClicks = 7;
        const correctPassword = "333";

        document.getElementById('secretTarget').addEventListener('click', function() {
            clickCount++;
            this.style.opacity = '0.8';
            this.style.transform = 'scale(1.2)';
            setTimeout(() => {
                this.style.opacity = '0.3';
                this.style.transform = 'scale(1)';
            }, 200);
            
            if (clickCount >= requiredClicks) {
                document.getElementById('passwordModal').style.display = 'flex';
                clickCount = 0;
                
                setTimeout(() => {
                    document.getElementById('passwordInput').focus();
                }, 100);
            }
        });

        function checkPassword() {
            const input = document.getElementById('passwordInput').value;
            const errorElement = document.getElementById('passwordError');
            
            if (input === correctPassword) {
                document.getElementById('passwordModal').style.display = 'none';
                document.getElementById('publicContent').style.display = 'none';
                document.getElementById('testingPlatform').style.display = 'block';
                document.getElementById('secretTarget').style.display = 'none';
            } else {
                errorElement.style.display = 'block';
                document.getElementById('passwordInput').value = '';
                
                setTimeout(() => {
                    document.getElementById('passwordInput').focus();
                }, 100);
                
                setTimeout(() => errorElement.style.display = 'none', 3000);
            }
        }

        document.getElementById('passwordModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
                clickCount = 0;
            }
        });

        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkPassword();
        });
    </script>
</body>
</html>
